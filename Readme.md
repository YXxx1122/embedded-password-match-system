# 嵌入式项目：口令匹配
## 程序功能
* 程序预先在内存中内置了经过哈希的密码，并从通过数字矩阵，接收用户输入密码。当用户输入完毕后，按下#键，程序将用户输入密码做哈希后，与内置密码的哈希值进行匹配，（并给出相应提示）。
* 用户的每一次按键，都将在数码管上显示，并且在下一次按键按下时，上一次的按键显示的值全部左移一位。
## 硬件组成
* 数字矩阵键盘
* LED数码管
* LED灯
* ...
## 内置密码设置
```uint8_t pwd_hash[5] = {4,1,3,2,9};```
* 内置密码长度为5。注意在程序中存储的并不是明文密码，而是经过哈希计算后的密文密码。
* 哈希算法为：哈希值=明文+1
## 输入
* 用户每次按下按键产生的输入键值会在switch_key函数中被转换为相应的数字值，并存储在全局变量flag中。

[![1.png](https://i.postimg.cc/MGSV1ymt/1.png)](https://postimg.cc/LJxJpg7Z)
## 输出
* 用户的每次按键输入，都会调用switch_flag函数来控制LED数码管进行显示。并且在下一次按键按下时，上一次的按键显示的值全部左移一位。
* ...
### verify_pwd函数
* 该函数主要有两个功能：
* 1. 将用户输入的前5个数字放入输入缓冲区中，超过5个后的数字不会被放入输入缓冲区。
* 2. 如果检测到用户输入#键，则将输入缓冲区中前5位有效值（或者小于5位）根据公式做哈希计算后，与内置密码的哈希值比较。并向串口输出匹配成功或匹配失败的提示信息。
* 3. 每次进行密码匹配后，都会把密码缓冲区指针置0，相当于刷新密码输入缓冲区，为下一次密码匹配做准备。
## 安全设置
* 输入长度限制。无论用户输入多少位密码，只有前5位（或小于5位）有效。大于5位后的只会显示，但不会存入密码缓冲区。
* 输入缓冲区防溢出。输入缓冲区有20字节长，大于密码的长度。虽然在verify_pwd中仅用到前5个字节，后15个字节都未用到，但能预防缓冲区溢出，提高程序安全性。
* 密码密文存储。在内存中存放的密码是经过哈希计算后的密文，保证密码秘密性，防止密码泄露。
* 执行冗余。核心函数verify_pwd有两个冗余函数，verify_pwd1和verify_pwd2，程序功能相同。在main程序中，每次while循环选择不同的verify_pwd执行。
* ...